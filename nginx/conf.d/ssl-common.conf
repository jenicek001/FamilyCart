# /etc/nginx/conf.d/ssl-common.conf  
# Common SSL configuration for server blocks (included per-site)
# Note: ssl_session_cache is defined globally in ssl-global.conf

# Modern SSL configuration - TLS 1.2 and 1.3 only (as per nginx docs)
ssl_protocols TLSv1.2 TLSv1.3;

# High-security cipher suite (from nginx documentation)
ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384;
ssl_prefer_server_ciphers off;

# HSTS header (can be overridden per site if needed)
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
